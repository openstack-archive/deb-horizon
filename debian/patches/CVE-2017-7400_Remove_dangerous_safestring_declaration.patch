Description: CVE-2017-7400: Remove dangerous safestring declaration
From: Richard Jones <r1chardj0n3s@gmail.com>
Date: Tue, 7 Mar 2017 05:55:39 +0000 (+1100)
X-Git-Tag: 10.0.3^2
X-Git-Url: https://review.openstack.org/gitweb?p=openstack%2Fhorizon.git;a=commitdiff_plain;h=511b325b45b6bd7a88bb6df1a4639b80d0121277
 This declaration allows XSS content through the JSON and
 is unnecessary for correct rendering of the content anyway.
Change-Id: I82355b37108609ae573237424e528aab86a24efc
Bug-Ubuntu: https://bugs.launchpad.net/horizon/+bug/1667086
Bug-Debian: https://bugs.debian.org/859559
Origin: https://review.openstack.org/#/c/442454/
Last-Update: 2017-04-04

diff --git a/openstack_dashboard/dashboards/identity/mappings/tables.py b/openstack_dashboard/dashboards/identity/mappings/tables.py
index df6e8f3..9c22285 100644
--- a/openstack_dashboard/dashboards/identity/mappings/tables.py
+++ b/openstack_dashboard/dashboards/identity/mappings/tables.py
@@ -14,7 +14,6 @@
 
 import json
 
-from django.utils import safestring
 from django.utils.translation import ugettext_lazy as _
 from django.utils.translation import ungettext_lazy
 
@@ -75,7 +74,7 @@ def get_rules_as_json(mapping):
     rules = getattr(mapping, 'rules', None)
     if rules:
         rules = json.dumps(rules, indent=4)
-    return safestring.mark_safe(rules)
+    return rules
 
 
 class MappingsTable(tables.DataTable):
